<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="pageTitle">Headphones - Ublio</title>
    <link rel="stylesheet" href="/src/css/main.css">
</head>

<body>
    <header class="header header-scrolled">
        <nav class="container">
            <div class="nav">
                <a href="/" class="logo">UBLIO</a>
                <ul class="nav-menu">
                    <li><a href="/" class="nav-link">Home</a></li>
                    <li><a href="/src/pages/products.html" class="nav-link active">Products</a></li>
                    <li><a href="/src/pages/about.html" class="nav-link">About</a></li>
                    <li><a href="/src/pages/contact.html" class="nav-link">Contact</a></li>
                </ul>
                <div class="nav-actions">
                    <a href="/src/pages/cart.html" class="icon-btn cart-icon">
                        <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2"
                            viewBox="0 0 24 24">
                            <circle cx="9" cy="21" r="1"></circle>
                            <circle cx="20" cy="21" r="1"></circle>
                            <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
                        </svg>
                        <span class="cart-count" id="cartCount">0</span>
                    </a>
                </div>
            </div>
        </nav>
    </header>

    <main style="margin-top: 100px; min-height: 70vh;">
        <section class="section">
            <div class="container">
                <h1 class="mb-8" id="categoryTitle">Headphones</h1>
                <div class="grid grid-4" id="productsGrid"></div>
            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="footer-bottom">
                <p>&copy; 2024 Ublio Audio. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script type="module">
        import productsData from '/src/data/products.json';
        import { createProductCard, updateCartCount } from '/src/js/main.js';

        // Filter products for headphones category
        const filteredProducts = productsData.products.filter(p => p.category === 'headphones');
        const categoryName = 'Headphones';

        document.getElementById('pageTitle').textContent = `${categoryName} - Ublio`;
        document.getElementById('categoryTitle').textContent = categoryName;

        const container = document.getElementById('productsGrid');
        container.innerHTML = filteredProducts.map((product, index) => createProductCard(product, index)).join('');

        document.querySelectorAll('.add-to-cart-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                e.preventDefault();
                e.stopPropagation();
                const productId = btn.dataset.productId;
                const product = productsData.products.find(p => p.id === productId);
                if (!product) return;

                let cart = JSON.parse(localStorage.getItem('ublioCart')) || [];
                const existing = cart.find(item => item.id === productId);

                const categoryFolder = {
                    'headphones': 'headphones',
                    'studio-headphones': 'studio-headphones',
                    'earbuds': 'earbuds',
                    'speakers': 'speakers',
                    'soundbars': 'soundbars',
                    'home-theatre': 'home-theatre',
                    'turntable': 'turntable',
                    'spectacles': 'spectacles',
                    'collaboration': 'collaboration'
                }[product.category] || 'products';

                if (existing) {
                    existing.quantity += 1;
                } else {
                    cart.push({
                        id: product.id,
                        name: product.name,
                        price: product.price,
                        image: `/images/products/${categoryFolder}/${product.images[0]}`,
                        quantity: 1
                    });
                }

                localStorage.setItem('ublioCart', JSON.stringify(cart));
                updateCartCount();
                alert(`${product.name} added to cart!`);
            });
        });

        updateCartCount();
    </script>
</body>

</html>